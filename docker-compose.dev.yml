services:
  erp-btp-dev:
    build: .
    container_name: erp-btp-dev
    ports:
      - "8080:8080"
    volumes:
      # VOLUMES DE DÉVELOPPEMENT : Modifications en temps réel
      - ./erp:/app/erp
      - ./main.py:/app/main.py
      - ./data:/app/data
      - ./logs:/app/logs
      - ./static:/app/static
    environment:
      - PYTHONUNBUFFERED=1
      - ERP_STORAGE_BACKEND=postgres
      - POSTGRES_HOST=${POSTGRES_HOST}
      - POSTGRES_PORT=${POSTGRES_PORT:-5432}
      - POSTGRES_DB=${POSTGRES_DB}
      - POSTGRES_USER=${POSTGRES_USER}
      - POSTGRES_PASSWORD=${POSTGRES_PASSWORD}
      # Mode développement : Rechargement automatique
      - NICEGUI_RELOAD=true
      # Configuration email
      - APP_URL=${APP_URL:-http://localhost:8080}
      - SMTP_SERVER=${SMTP_SERVER}
      - SMTP_PORT=${SMTP_PORT:-587}
      - SMTP_USERNAME=${SMTP_USERNAME}
      - SMTP_PASSWORD=${SMTP_PASSWORD}
      - SMTP_FROM=${SMTP_FROM}
    restart: unless-stopped
    command: python main.py
